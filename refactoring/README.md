# Refactoring (Martin Fowler)

내용 자체는 당연한 말들의 연속이었다. 하지만 그 당연한 것들이 모두 명확하게 머리에 들어있는 사람은 많지 않다. 모든 개발자들이 리팩토링에 대해 이것저것 떠들곤 하지만, 그들 중 대부분은 상당 부분 빈약한 근거에 의존한 막연한 원칙들에 따라 리팩토링을 하고 있을 것이다. 이 책은 개발자들로 하여금 리팩토링을 할 때 활용할 수 있을 만한 테크닉들을 명시적으로 알려주고, 그러한 테크닉들이 가져올 수 있는 이득을 명확하게 알려줌으로써 리팩토링의 질을 한 단계 높여줄 수 있다는 데에 의미가 있을 것 같다. 이 책을 읽으면서 신경써야 할 부분은 단순히 나열된 테크닉을 학습하는 것이 아니라 어떤 상황에서 그 테크닉을 사용할 수 있을 지 고민해보는 것이라고 생각한다.

## 리팩토링의 원리

### 리팩토링이란?

> 소프트웨어를 보다 쉽게 이해할 수 있고, 적은 비용으로 수정할 수 있도록 겉으로 보이는 동작의 변화 없이 내부 구조를 변경하는 것.

### 두 개의 모자

kent beck은 소프트웨어 개발의 과정에서 개발자는 두 개의 모자를 번갈아 가며 쓴다고 표현한다. 이 둘은 각각 기능 추가와 리팩토링을 뜻하는데, 개발자들은 보통 개발을 해나가면서 수시로 모자를 바꿔쓰게 될 것이다. 개발자들은 항상 자신이 현재 어떤 모자를 쓰고 있는지 알고 있어야 한다.

### 리팩토링을 해야 하는 이유

- 디자인의 개선
- 코드의 가독성 개선
- 디버깅 용이성 증가
- 결과적인 생산성 증가

### 언제 리팩토링을 해야 하는가?

리팩토링은 리팩토링 그 자체보다 리팩토링을 언제 할 지 결정하는 것이 더 중요하다고 생각한다. 릴리즈가 다가오는데 기능 추가 없이 리팩토링만을 하고 있을 수도 없는 노릇이고, 리팩토링을 하고 있다는 사실이 팀 내에 확실히 전파되지 않을 경우 더 큰 혼란을 초래할 수도 있을 것이다. 아래는 언제 리팩토링을 할 지 대략적으로 결정할 수 있는 몇가지 가이드라인이다.

**삼진 규칙**

어떤 것을 처음 할 때는 그냥 한다. 두 번째로 비슷한 어떤 것을 하게 되면 중복 때문에 주춤하지만 그냥 중복되도록 한다. 세번째로 비슷한 것을 하게 되면 그때 리팩토링을 한다.

**기능을 추가할 때 리팩토링을 하라**

기능을 추가하기 위해서는 기존 코드를 확인해야 한다. 새로운 기능을 추가할 때 이해할 필요가 있는 기존 코드들이 가독성이 낮거나 잘못 설계되어 있다면 이 때가 리팩토링을 할 적절한 시기가 될 수 있다.

**버그를 수정해야할 때 리팩토링을 하라**

리팩토링은 버그를 수정할 때 코드를 좀 더 쉽게 이해하기 위해서 사용된다. 버그 리포트는 리팩토링이 필요하다는 신호로도 볼 수 있는데, 그 이유는 버그가 있었다는 것을 몰랐을 정도로 코드가 명확하지 않았다는 뜻이기 때문이다.

**코드 리뷰를 할 때 리팩토링을 하라**

코드 리뷰를 할 때 리팩토링을 하는 것은 당연하다.